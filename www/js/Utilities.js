var Utilities={VERSION:"17",REVISION:0,LOCAL_MODIFICATIONS:0,BRANCH:"v17.x",exc:console_error_safe,error:console_error_safe,warn:console_warn_safe,log:console_log_safe,debug:console_debug_safe,cexc:console_error_safe,cerror:console_error_safe,cwarn:console_warn_safe,clog:console_log_safe,cdebug:console_debug_safe,stristrue(v,default_value){return v?["true","on","1","yes","enabled"].includes(String(v).toLowerCase()):default_value},removeChars(validChars,inputString){validChars=new RegExp("[^"+validChars+"]","g");return inputString.replace(validChars,"")},getHexUUID(){for(var s=[],index=0;index<36;index++)s[index]=8==index||13==index||18==index||23==index?"-":"0123456789abcdef".slice(Math.floor(16*Math.random()),Math.floor(16*Math.random())+1);return s.join("")},ord(c){return c.charCodeAt(0)},getSecureRandomBytes(len){len=new Uint8Array(len);return crypto.getRandomValues(len),len},getSecureRandomString(len){len=Utilities.getSecureRandomBytes(len);return String.fromCharCode.apply(null,len)},xorString(string1,string2){if(string1.length!==string2.length)throw"strings must be equal length";for(var result="",index=0;index<string1.length;index++){var character1=string1[index],character2=string2[index];result+=String.fromCharCode(character1.charCodeAt(0)^character2.charCodeAt(0))}return result},u8(value){var type=typeof value;return"object"==type&&value.constructor===Uint8Array?value:"string"==type?Uint8Array.from(value.split("").map(x=>x.charCodeAt())):new Uint8Array(value)},gendigest(digest,password,salt){var trimmed_salt,hash;return"xor"==digest?(trimmed_salt=salt.slice(0,password.length),new Promise(function(resolve,reject){resolve(Utilities.xorString(trimmed_salt,password))})):digest.startsWith("hmac")?(hash="SHA-1",(hash=(hash=0<digest.indexOf("+")?digest.split("+")[1]:hash).toUpperCase()).startsWith("SHA")&&!hash.startsWith("SHA-")&&(hash="SHA-"+hash.substring(3)),new Promise(function(resolve,reject){crypto.subtle.importKey("raw",Utilities.u8(password),{name:"HMAC",hash:hash},!1,["sign","verify"]).then(key=>{Utilities.cdebug("imported hmac key: ",key);var u8salt=Utilities.u8(salt);crypto.subtle.sign("HMAC",key,u8salt).then(result=>{result=new Uint8Array(result);Utilities.clog("hmac result=",result),resolve(Utilities.ArrayBufferToString(result))},error=>{Utilities.clog("hmac signing failed:",error),reject(error)})},error=>{Utilities.clog("hmac key import failed:",error),reject(error)})})):new Promise(function(resolve,reject){reject(new Error("unsupported digest '"+digest+"'"))})},trimString(string_,trimLength){return string_?string_.length>trimLength?string_.slice(0,Math.max(0,trimLength-3))+"...":string_:""},convertToHex(string_){for(var hex="",index=0;index<string_.length;index++)hex+=""+string_.charCodeAt(index).toString(16).padStart(2,"0");return hex},hexToString(hexval){for(var hex=hexval.toString(),str="",i=0;i<hex.length;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str},arrayhex(arr){return Array.from(arr).map(b=>b.toString(16).padStart(2,"0")).join("")},arrayToHex(buffer){return Array.prototype.map.call(buffer,x=>("00"+x.toString(16)).slice(-2)).join("")},hexarray(hex){for(var bytes=new Uint8Array(Math.ceil(hex.length/2)),i=0;i<bytes.length;i++)bytes[i]=parseInt(hex.substr(2*i,2),16);return bytes},getPlatformProcessor(){return navigator.oscpu||(Object.hasOwn((navigator,"cpuClass"))?navigator.cpuClass:"unknown")},getPlatformName(){return navigator.appVersion.includes("Win")?"Microsoft Windows":navigator.appVersion.includes("Mac")?"Mac OSX":navigator.appVersion.includes("Linux")?"Linux":navigator.appVersion.includes("X11")?"Posix":"unknown"},getPlatform(){return navigator.appVersion.includes("Win")?"win32":navigator.appVersion.includes("Mac")?"darwin":navigator.appVersion.includes("Linux")?"linux":navigator.appVersion.includes("X11")?"posix":"unknown"},getFirstBrowserLanguage(){var property,nav=window.navigator;if(Array.isArray(nav.languages))for(var language of nav.languages)if(language&&0<language.length)return language;for(property of["language","browserLanguage","systemLanguage","userLanguage"])if((language=nav[property])&&0<language.length)return language;return null},getKeyboardLayout(){var layout,l,v=Utilities.getFirstBrowserLanguage();return null==v?"us":!(layout=LANGUAGE_TO_LAYOUT[v])&&(layout=(l=1===(l=(v=v.split(",")[0]).split("-",2)).length?v.split("_",2):l)[0].toLowerCase(),v=LANGUAGE_TO_LAYOUT[layout])?v:layout},isMacOS(){return navigator.platform.includes("Mac")},isWindows(){return navigator.platform.includes("Win")},isLinux(){return navigator.platform.includes("Linux")},isFirefox(){return navigator.userAgent.toLowerCase().includes("firefox")},isOpera(){return navigator.userAgent.toLowerCase().includes("opera")},isSafari(){var ua=navigator.userAgent.toLowerCase();return ua.includes("safari")&&!ua.includes("chrome")},isWebkit(){return navigator.userAgent.toLowerCase().includes("webkit")},isEdge(){return navigator.userAgent.includes("Edge")},isChrome(){var isChromium=Object.hasOwn(window,"chrome"),winNav=window.navigator,vendorName=winNav.vendor,isOpera=winNav.userAgent.includes("OPR"),isIEedge=winNav.userAgent.includes("Edge");return!!winNav.userAgent.match("CriOS")||null!=isChromium&&"Google Inc."===vendorName&&!1===isOpera&&!1===isIEedge},isIE(){return navigator.userAgent.includes("MSIE")||navigator.userAgent.includes("Trident/")},is_64bit(){var a,_to_check=[],_64bits_signatures=(Object.hasOwn((window.navigator,"cpuClass"))&&_to_check.push((""+window.navigator.cpuClass).toLowerCase()),window.navigator.platform&&_to_check.push((""+window.navigator.platform).toLowerCase()),navigator.userAgent&&_to_check.push((""+navigator.userAgent).toLowerCase()),["x86_64","x86-64","Win64","x64;","amd64","AMD64","WOW64","x64_64","ia64","sparc64","ppc64","IRIX64"]);for(a of _to_check)for(var b of _64bits_signatures)if(a.includes(b.toLowerCase()))return!0;return!1},isMobile(){return/iphone|ipad|ipod|android/i.test(navigator.userAgent)},getSimpleUserAgentString(){return Utilities.isFirefox()?"Firefox":Utilities.isOpera()?"Opera":Utilities.isSafari()?"Safari":Utilities.isChrome()?"Chrome":Utilities.isIE()?"MSIE":""},getColorGamut(){return window.matchMedia?window.matchMedia("(color-gamut: rec2020)").matches?"rec2020":window.matchMedia("(color-gamut: p3)").matches?"P3":window.matchMedia("(color-gamut: srgb)").matches?"srgb":"":""},isEventSupported(event){var isSupported,testElement=document.createElement("div");return(isSupported=(event="on"+event)in testElement)||(testElement.setAttribute(event,"return;"),isSupported="function"==typeof testElement[event]),testElement=null,isSupported},normalizeWheel(event){var sX=0,sY=0,pX=("detail"in event&&(sY=event.detail),"wheelDelta"in event&&(sY=-event.wheelDelta/120),"wheelDeltaY"in event&&(sY=-event.wheelDeltaY/120),"wheelDeltaX"in event&&(sX=-event.wheelDeltaX/120),"axis"in event&&event.axis===event.HORIZONTAL_AXIS&&(sX=sY,sY=0),10*sX),pY=10*sY;return"deltaY"in event&&(pY=event.deltaY),((pX="deltaX"in event?event.deltaX:pX)||pY)&&event.deltaMode&&(1==event.deltaMode?(pX*=40,pY*=40):(pX*=800,pY*=800)),{spinX:sX=pX&&!sX?pX<1?-1:1:sX,spinY:sY=pY&&!sY?pY<1?-1:1:sY,pixelX:pX,pixelY:pY,deltaMode:event.deltaMode||0}},saveFile(filename,data,mimetype){var a=document.createElement("a"),data=(a.setAttribute("style","display: none"),document.body.append(a),new Blob([data],mimetype)),mimetype=window.URL.createObjectURL(data);navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(data,filename):(a.href=mimetype,a.download=filename,a.click(),window.URL.revokeObjectURL(mimetype))},StringToUint8(value){return(new TextEncoder).encode(value)},Uint8ToString(value){return(new TextDecoder).decode(value)},s(v){return void 0===v?"":"object"==typeof v&&v.constructor===Uint8Array?Utilities.Uint8ToString(v):v.toString()},u(v){return void 0===v?new Uint8Array(0):"object"==typeof v&&v.constructor===Uint8Array?v:Utilities.StringToUint8(v.toString())},ArrayBufferToString(uintArray){var s="";if(uintArray.subarray)for(var index=0,length_=uintArray.length;index<length_;index+=10400)s+=String.fromCharCode.apply(null,uintArray.subarray(index,Math.min(index+10400,length_)));else for(index=0,length_=uintArray.length;index<length_;index+=10400)s+=String.fromCharCode.apply(null,uintArray.slice(index,Math.min(index+10400,length_)));return s},ArrayBufferToBase64(uintArray){return window.btoa(Utilities.ArrayBufferToString(uintArray))},ToBase64(v){try{return window.btoa(v)}catch{return ArrayBufferToBase64(v)}},convertDataURIToBinary(dataURI){for(var base64Index=dataURI.indexOf(";base64,")+";base64,".length,dataURI=dataURI.slice(Math.max(0,base64Index)),raw=window.atob(dataURI),rawLength=raw.length,array=new Uint8Array(new ArrayBuffer(rawLength)),index=0;index<rawLength;index++)array[index]=raw.charCodeAt(index);return array},parseINIString(data){var line,match,regex={section:/^\s*\[\s*([^\]]*)\s*]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*[#;].*$/},value={},section=null;for(line of data.split(/[\n\r]+/))regex.comment.test(line)||(regex.param.test(line)?(match=line.match(regex.param),section?value[section][match[1]]=match[2]:value[match[1]]=match[2]):regex.section.test(line)?(value[(match=line.match(regex.section))[1]]={},section=match[1]):0===line.length&&(section=section&&null));return value},isSafeHost(host){return host&&0<=["localhost","127.0.0.1","::1"].indexOf(host)},ParseResponseHeaders(headerString){var headerPair,headers={};if(headerString)for(headerPair of headerString.split("\r\n")){var key,index=headerPair.indexOf(": ");0<index&&(key=headerPair.slice(0,Math.max(0,index)),index=headerPair.slice(Math.max(0,index+2)),headers[key]=index)}return headers},parseParams(q){for(var e,parameters={},a=/\+/g,r=/([^&=]+)=?([^&]*)/g,d=s=>decodeURIComponent(s.replace(a," "));e=r.exec(q);)parameters[d(e[1])]=d(e[2]);return parameters},getparam(property){var value=(window.location.getParameter||function(key){return window.location.queryStringParams||(window.location.queryStringParams=Utilities.parseParams(window.location.search.slice(1))),window.location.queryStringParams[key]})(property);if(void 0===value)try{value=Utilities.getSessionStorageValue(property)}catch{}return value},getboolparam(property,default_value){property=Utilities.getparam(property);return void 0===property?default_value:["true","on","1","yes","enabled"].includes(String(property).toLowerCase())},hasSessionStorage(){if("undefined"==typeof Storage)return!1;try{var key="just for testing sessionStorage support";return sessionStorage.setItem(key,"store-whatever"),sessionStorage.removeItem(key),!0}catch{return!1}},getSessionStorageValue(property){var params=JSON.parse(sessionStorage.getItem(Utilities.getSessionStoragePrefix()));if(property in params)return String(params[property])},setSessionStorageValue(property,value){var prefix=Utilities.getSessionStoragePrefix(),params=JSON.parse(sessionStorage.getItem(prefix))||{};null===value||"undefined"===value?delete params[property]:params[property]=String(value),sessionStorage.setItem(prefix,JSON.stringify(params))},clearSessionStorage(){sessionStorage.removeItem(Utilities.getSessionStoragePrefix())},getSessionStoragePrefix(){var urlPath=new URL(window.location.href).pathname;return urlPath.substring(0,urlPath.lastIndexOf("/"))},getConnectionInfo(){var c,index;return Object.hasOwn(navigator,"connection")?(index={},(c=navigator.connection).type&&(index.type=c.type),Object.hasOwn("effectiveType")&&(index["effective-type"]=c.effectiveType),!isNaN(c.downlink)&&0<c.downlink&&isFinite(c.downlink)&&(index.downlink=Math.round(1e3*c.downlink*1e3)),Object.hasOwn(c,"downlinkMax")&&!isNaN(c.downlinkMax)&&!isNaN(c.downlinkMax)&&0<c.downlinkMax&&isFinite(c.downlinkMax)&&(index["downlink.max"]=Math.round(1e3*c.downlinkMax*1e3)),!isNaN(c.rtt)&&0<c.rtt&&(index.rtt=c.rtt),index):{}},json_action(uri,success_function,error_function,username,password){Utilities.log("json_action(",uri,", ",success_function,", ",error_function,")");var xhr=new XMLHttpRequest,url=uri;return uri.startsWith("/")&&(url=document.location.href.split("/connect.html")[0]+uri),xhr.open("GET",url,!0),username&&password&&(username=btoa(username+":"+password),xhr.setRequestHeader("Authorization","Basic "+username)),xhr.responseType="json",xhr.addEventListener("load",function(){Utilities.log("loaded",url,"status",xhr.status);var status=xhr.status;200===status?success_function(xhr,xhr.response):(Utilities.log(uri,"failed:",status+xhr.response),error_function&&error_function("failed: "+status+xhr.response))}),xhr.addEventListener("error",function(e){Utilities.log(uri,"error:",e),error_function&&error_function(e)}),xhr.addEventListener("abort",function(e){Utilities.log(uri,"abort:",e),error_function&&error_function(e)}),xhr.send(),xhr}},LANGUAGE_TO_LAYOUT={en_GB:"gb",en:"us",zh:"cn",af:"za",sq:"al",ca:"ca","zh-TW":"tw","zh-CN":"cn",cs:"cz",da:"dk","nl-BE":"be","en-US":"us","en-AU":"us","en-GB":"gb","en-CA":"ca","en-NZ":"us","en-IE":"ie","en-ZA":"za","en-JM":"us","en-TT":"tr",et:"ee",fa:"ir","fr-BE":"be","fr-CA":"ca","fr-CH":"ch","fr-LU":"fr","gd-IE":"ie","de-CH":"ch","de-AT":"at","de-LU":"de","de-LI":"de",he:"il",hi:"in","it-CH":"ch",ja:"jp",ko:"kr","pt-BR":"br",pt:"pt",sr:"rs",sl:"si",es:"es",sv:"se","sv-FI":"fi",tr:"tr",uk:"ua",ur:"pk",vi:"vn"};function console_debug_safe(){console&&console.debug.apply(console,arguments)}function console_error_safe(){console&&console.error.apply(console,arguments)}function console_warn_safe(){console&&console.warn.apply(console,arguments)}function console_log_safe(){console&&console.log.apply(console,arguments)}